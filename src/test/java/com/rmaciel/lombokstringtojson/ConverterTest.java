package com.rmaciel.lombokstringtojson;

import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class ConverterTest {

  @Test
  void whenInputHasTwoSimpleFields_ThenItShouldReturnAJsonString() {
    String result = Converter.convert("Class(field=value1, other_field=2value)");

    assertEquals("{\"field\":\"value1\", \"other_field\":\"2value\"}", result);
  }

  @Test
  void whenInputHasAListWithMultipleValue_ThenItShouldReturnAJsonStringWithAList() {
    String result =
        Converter.convert(
            "Class(field=value1, other_field=[Inner(inner_field=1), Inner(inner_field=2)])");

    assertEquals(
        "{\"field\":\"value1\", \"other_field\":[{\"inner_field\":\"1\"}, {\"inner_field\":\"2\"}]}",
        result);
  }

  @Test
  void whenInputIsComplex_ThenItShouldStillReturnAValidJson() {
    String result =
        Converter.convert(
            "PaymentEntries(payments=[Payment(paymentID=null, associateOID=3F08F5EB16BB4E71, paymentCalculationID=1ef0987c-8710-06f2-ac86-fdeef777d11c, workAgreementID=EMP0111, taxReportingClassificationCode=Code(code=null), fein=null, payPeriodReference=PayPeriodReference(payPeriodID=2023-01, payScheduleID=1ef0987c-85a2-031c-b24b-c19a16d0a692, payPeriodPayDate=2023-01-02, payPeriodStartDate=2023-01-01, payPeriodEndDate=2023-01-31, statutoryBaseDate=2023-01-02, payPeriodCalendarReferences=[PayPeriodCalendarReference(calendarTypeCode=CalendarType(code=TAX, name=Tax Calendar), calendarContextCountryCode=CL, calendarPeriodReferences=[CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=MONTH, name=Month Calendar Unit), calendarUnitReference=1, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-01-31, numberOfPayPeriods=1), CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=QUARTER, name=Quarter Calendar Unit), calendarUnitReference=1, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-03-31, numberOfPayPeriods=4), CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=YEAR, name=Year Calendar Unit), calendarUnitReference=2023, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-12-31, numberOfPayPeriods=12)], links=[{href=/api/payment-service/v1/compliance-calendar/CL/periods?asOfDate=2023-01-02, rel=related, mediaType=application/json, method=GET}])], payPeriodStartDateCalendarReferences=[PayPeriodCalendarReference(calendarTypeCode=CalendarType(code=TAX, name=Tax Calendar), calendarContextCountryCode=CL, calendarPeriodReferences=[CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=MONTH, name=Month Calendar Unit), calendarUnitReference=1, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-01-31, numberOfPayPeriods=1), CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=QUARTER, name=Quarter Calendar Unit), calendarUnitReference=1, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-03-31, numberOfPayPeriods=4), CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=YEAR, name=Year Calendar Unit), calendarUnitReference=2023, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-12-31, numberOfPayPeriods=12)], links=[{href=/api/payment-service/v1/compliance-calendar/CL/periods?asOfDate=2023-01-01, rel=related, mediaType=application/json, method=GET}])], payPeriodEndDateCalendarReferences=[PayPeriodCalendarReference(calendarTypeCode=CalendarType(code=TAX, name=Tax Calendar), calendarContextCountryCode=CL, calendarPeriodReferences=[CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=MONTH, name=Month Calendar Unit), calendarUnitReference=1, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-01-31, numberOfPayPeriods=1), CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=QUARTER, name=Quarter Calendar Unit), calendarUnitReference=1, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-03-31, numberOfPayPeriods=4), CalendarPeriodReference(calendarUnitCode=CalendarUnitCode(code=YEAR, name=Year Calendar Unit), calendarUnitReference=2023, calendarUnitPeriodStartDate=2023-01-01, calendarUnitPeriodEndDate=2023-12-31, numberOfPayPeriods=12)], links=[{href=/api/payment-service/v1/compliance-calendar/CL/periods?asOfDate=2023-01-31, rel=related, mediaType=application/json, method=GET}])]), reportingPayPeriodReference=null, legalEntity=LegalEntityReference(legalEntityID=72-5984391, countryCode=CL), payrollExecutionDateTime=null, paymentProcess=null, subdivisionCode=null, paymentStatusCode=null, paymentPayDate=2023-01-02, paymentAmount=null, paymentDistributions=null, externalTags=null, payCycleCode=MONTHLY, taxCalendarPeriodReferences=null, statutoryReportingGroups=null, paymentType=null)], reportingPayPeriodReference=null, metaData=null)");

    assertEquals(
            "{\"payments\":[{\"paymentID\":\"null\", \"associateOID\":\"3F08F5EB16BB4E71\", \"paymentCalculationID\":\"1ef0987c-8710-06f2-ac86-fdeef777d11c\", \"workAgreementID\":\"EMP0111\", \"taxReportingClassificationCode\":{\"code\":\"null\"}, \"fein\":\"null\", \"payPeriodReference\":{\"payPeriodID\":\"2023-01\", \"payScheduleID\":\"1ef0987c-85a2-031c-b24b-c19a16d0a692\", \"payPeriodPayDate\":\"2023-01-02\", \"payPeriodStartDate\":\"2023-01-01\", \"payPeriodEndDate\":\"2023-01-31\", \"statutoryBaseDate\":\"2023-01-02\", \"payPeriodCalendarReferences\":[{\"calendarTypeCode\":{\"code\":\"TAX\", \"name\":\"Tax Calendar\"}, \"calendarContextCountryCode\":\"CL\", \"calendarPeriodReferences\":[{\"calendarUnitCode\":{\"code\":\"MONTH\", \"name\":\"Month Calendar Unit\"}, \"calendarUnitReference\":\"1\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-01-31\", \"numberOfPayPeriods\":\"1\"}, {\"calendarUnitCode\":{\"code\":\"QUARTER\", \"name\":\"Quarter Calendar Unit\"}, \"calendarUnitReference\":\"1\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-03-31\", \"numberOfPayPeriods\":\"4\"}, {\"calendarUnitCode\":{\"code\":\"YEAR\", \"name\":\"Year Calendar Unit\"}, \"calendarUnitReference\":\"2023\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-12-31\", \"numberOfPayPeriods\":\"12\"}], \"links\":[{\"href\":\"/api/payment-service/v1/compliance-calendar/CL/periods?asOfDate=2023-01-02\", \"rel\":\"related\", \"mediaType\":\"application/json\", \"method\":\"GET\"}]}], \"payPeriodStartDateCalendarReferences\":[{\"calendarTypeCode\":{\"code\":\"TAX\", \"name\":\"Tax Calendar\"}, \"calendarContextCountryCode\":\"CL\", \"calendarPeriodReferences\":[{\"calendarUnitCode\":{\"code\":\"MONTH\", \"name\":\"Month Calendar Unit\"}, \"calendarUnitReference\":\"1\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-01-31\", \"numberOfPayPeriods\":\"1\"}, {\"calendarUnitCode\":{\"code\":\"QUARTER\", \"name\":\"Quarter Calendar Unit\"}, \"calendarUnitReference\":\"1\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-03-31\", \"numberOfPayPeriods\":\"4\"}, {\"calendarUnitCode\":{\"code\":\"YEAR\", \"name\":\"Year Calendar Unit\"}, \"calendarUnitReference\":\"2023\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-12-31\", \"numberOfPayPeriods\":\"12\"}], \"links\":[{\"href\":\"/api/payment-service/v1/compliance-calendar/CL/periods?asOfDate=2023-01-01\", \"rel\":\"related\", \"mediaType\":\"application/json\", \"method\":\"GET\"}]}], \"payPeriodEndDateCalendarReferences\":[{\"calendarTypeCode\":{\"code\":\"TAX\", \"name\":\"Tax Calendar\"}, \"calendarContextCountryCode\":\"CL\", \"calendarPeriodReferences\":[{\"calendarUnitCode\":{\"code\":\"MONTH\", \"name\":\"Month Calendar Unit\"}, \"calendarUnitReference\":\"1\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-01-31\", \"numberOfPayPeriods\":\"1\"}, {\"calendarUnitCode\":{\"code\":\"QUARTER\", \"name\":\"Quarter Calendar Unit\"}, \"calendarUnitReference\":\"1\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-03-31\", \"numberOfPayPeriods\":\"4\"}, {\"calendarUnitCode\":{\"code\":\"YEAR\", \"name\":\"Year Calendar Unit\"}, \"calendarUnitReference\":\"2023\", \"calendarUnitPeriodStartDate\":\"2023-01-01\", \"calendarUnitPeriodEndDate\":\"2023-12-31\", \"numberOfPayPeriods\":\"12\"}], \"links\":[{\"href\":\"/api/payment-service/v1/compliance-calendar/CL/periods?asOfDate=2023-01-31\", \"rel\":\"related\", \"mediaType\":\"application/json\", \"method\":\"GET\"}]}]}, \"reportingPayPeriodReference\":\"null\", \"legalEntity\":{\"legalEntityID\":\"72-5984391\", \"countryCode\":\"CL\"}, \"payrollExecutionDateTime\":\"null\", \"paymentProcess\":\"null\", \"subdivisionCode\":\"null\", \"paymentStatusCode\":\"null\", \"paymentPayDate\":\"2023-01-02\", \"paymentAmount\":\"null\", \"paymentDistributions\":\"null\", \"externalTags\":\"null\", \"payCycleCode\":\"MONTHLY\", \"taxCalendarPeriodReferences\":\"null\", \"statutoryReportingGroups\":\"null\", \"paymentType\":\"null\"}], \"reportingPayPeriodReference\":\"null\", \"metaData\":\"null\"}",
        result);
  }
}
